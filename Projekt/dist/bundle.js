!function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);var s,n=(s=function(t,i){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)},function(t,i){function e(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}),h=new Image;h.src="http://tsgk.captainn.net/sheets/nes/bomberman2_various_sheet.png",h.onload=function(){!function(){this.startAnimating(15)}()};var o,r=function(){function t(t,i,e,s,n){this.onFire=null,this.playerOn=null,this.spriteWidth=40,this.spriteHeight=30,this.context=t,this.x=i,this.y=e,this.SIZE_X=s,this.SIZE_Y=n}return t.prototype.draw=function(){var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillStyle="yellow",this.context.fillRect(t,i,this.SIZE_X,this.SIZE_Y)},t.prototype.update=function(){},t.prototype.setOnFire=function(){},t.prototype.drawAnimation=function(t,i,e,s){this.context.drawImage(h,t*this.spriteWidth,i*this.spriteHeight,this.spriteWidth,this.spriteHeight,e,s,this.SIZE_X,this.SIZE_Y)},t}(),a=function(t){function i(i,e,s,n,h){return t.call(this,i,e,s,n,h)||this}return n(i,t),i.prototype.draw=function(){var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillStyle="grey",this.context.fillRect(t,i,this.SIZE_X,this.SIZE_Y)},i}(r),l=function(t){function i(i,e,s,n,h){var o=t.call(this,i,e,s,n,h)||this;return o.bombOnItem=null,o.onFire=null,o.brickOnItem=null,o.overlayingItem=[],o}return n(i,t),i.prototype.update=function(){null!==this.onFire&&null!==this.playerOn&&(this.playerOn.alive=!1)},i.prototype.draw=function(){null===this.playerOn?this.context.fillStyle="green":this.context.fillStyle="red";var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillRect(t,i,this.SIZE_X,this.SIZE_Y),null!==this.bombOnItem&&(this.bombOnItem.update(),this.bombOnItem.draw()),null!==this.onFire&&(this.onFire.update(),this.onFire.draw()),null!==this.brickOnItem&&this.brickOnItem.draw()},i.prototype.setOnFire=function(){null!==this.playerOn&&(this.playerOn.alive=!1),null!==this.brickOnItem?this.brickOnItem.setOnFire():this.onFire=new f(this.context,this.x,this.y,this.SIZE_X,this.SIZE_Y,this)},i}(r),c=function(t){function i(i,e,s,n,h){return t.call(this,i,e,s,n,h)||this}return n(i,t),i.prototype.draw=function(){var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillStyle="black",this.context.fillRect(t,i,this.SIZE_X,this.SIZE_Y),null!==this.onFire&&(this.onFire.update(),this.onFire.draw())},i.prototype.update=function(){null!==this.playerOn&&(this.playerOn.alive=!1)},i.prototype.setOnFire=function(){this.onFire=new f(this.context,this.x,this.y,this.SIZE_X,this.SIZE_Y,this)},i}(l),u=function(t){function i(i,e,s,n,h,o){var r=t.call(this,i,e,s,n,h)||this;return r.explode=!1,r.timeLeft=100,r.timeLeftToDrop=10,r.placedOn=o,r}return n(i,t),i.prototype.draw=function(){if(this.explode){var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.drawAnimation(5,3,t-10,i-10)}else{t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.drawAnimation(5,3,t+10,i+10)}},i.prototype.update=function(){this.timeLeft<0?(this.explode=!0,this.timeLeftToDrop<0?(this.placedOn.bombOnItem=null,this.placedOn.onFire=new f(this.context,this.x,this.y,this.SIZE_X,this.SIZE_Y,this.placedOn)):--this.timeLeftToDrop):--this.timeLeft},i}(r),y=function(){function t(t,i,e,s,n,h){this.breakBricks=!1,this.context=t,this.x=i,this.y=e,this.SIZE_X=s,this.SIZE_Y=n,this.placedOn=h}return t.prototype.draw=function(){if(this.breakBricks){var t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillStyle="yellow",this.context.fillRect(t-10,i-10,this.SIZE_X+10,this.SIZE_Y+10),this.placedOn.setOnFire(),this.placedOn.brickOnItem=null}else{t=this.x*this.SIZE_X,i=this.y*this.SIZE_Y;this.context.fillStyle="pink",this.context.fillRect(t,i,this.SIZE_X,this.SIZE_Y)}},t.prototype.setOnFire=function(){this.breakBricks=!0},t}(),f=function(){function t(t,i,e,s,n,h){this.timeLeft=20,this.context=t,this.xPos=i,this.yPos=e,this.xSize=s,this.ySize=n,this.placedOn=h}return t.prototype.draw=function(){var t=this.xPos*this.xSize,i=this.yPos*this.ySize;this.context.fillStyle="orange",this.context.fillRect(t,i,this.xSize,this.ySize)},t.prototype.update=function(){this.timeLeft<1&&(this.placedOn.onFire=null),--this.timeLeft},t}(),p=function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();!function(t){t[t.NORTH=0]="NORTH",t[t.SOUTH=1]="SOUTH",t[t.WEST=2]="WEST",t[t.EAST=3]="EAST"}(o||(o={}));var x=new Image;x.src="http://tsgk.captainn.net/sheets/nes/bomberman2_various_sheet.png",x.onload=function(){!function(){this.startAnimating(15)}()};var d,L=function(t){function i(i){var e=t.call(this,i)||this;return document.addEventListener("keydown",function(t){if(!e.running&&e.alive)switch(t.key){case"ArrowUp":e.checkCollide(e.onItem.x,e.onItem.y-1)&&(e.direction=o.NORTH,e.running=!0);break;case"ArrowDown":e.checkCollide(e.onItem.x,e.onItem.y+1)&&(e.direction=o.SOUTH,e.running=!0);break;case"ArrowRight":e.checkCollide(e.onItem.x+1,e.onItem.y)&&(e.direction=o.EAST,e.running=!0);break;case"ArrowLeft":e.checkCollide(e.onItem.x-1,e.onItem.y)&&(e.direction=o.WEST,e.running=!0);break;case"y":if("y"===t.key){var i=e.onItem;i.bombOnItem=new u(e.onItem.context,e.onItem.x,e.onItem.y,e.onItem.SIZE_X,e.onItem.SIZE_Y,i);break}case"x":if("x"===t.key){null!=e.inventory&&e.inventory.use();break}}}),e}return p(i,t),i.prototype.checkCollide=function(t,i){if(null===this.onItem)throw new Error('Field is not connected to Player:\n\t"this.onItem === null"');var e=8*i+t,s=e>=0&&e<this.field.items.length,n=this.field.items[e]instanceof l;if(s&&n&&null===this.field.items[e].brickOnItem)return this.target=e,!0},i}(function(){function t(t){this.transitionCounter=0,this.TRANSITION_UPPER_BOUND=5,this.target=0,this.loosingSequence=0,this.alive=!0,this.hitPoints=1,this.movementSpeed=10,this.inventory=null,this.visible=!0,this.spriteWidth=28,this.spriteHeight=30,this.cycleLoopPlayer=[0,1,0,2],this.currentLoopIndex=0,this.frameCount=0,this.xPos=0,this.yPos=0,this.field=null,this.onItem=null,this.running=!1,this.canvas=document.getElementById("game-layer"),this.context=this.canvas.getContext("2d")}return t.prototype.initField=function(t,i){this.field=t,i.playerOn=this,this.onItem=i,this.xPos=i.x*this.field.xSize,this.yPos=i.y*this.field.ySize},t.prototype.renderPlayer=function(){if(this.running)if(this.transitionCounter<this.TRANSITION_UPPER_BOUND){switch(this.direction){case o.NORTH:this.yPos-=this.field.ySize/this.TRANSITION_UPPER_BOUND,this.currentDirection=2;break;case o.SOUTH:this.yPos+=this.field.ySize/this.TRANSITION_UPPER_BOUND,this.currentDirection=0;break;case o.WEST:this.xPos-=this.field.xSize/this.TRANSITION_UPPER_BOUND,this.currentDirection=1;break;case o.EAST:this.xPos+=this.field.xSize/this.TRANSITION_UPPER_BOUND,this.currentDirection=3}++this.transitionCounter}else{this.transitionCounter=0,this.running=!1;var t=this.onItem;this.onItem=this.field.items[this.target],this.onItem.playerOn=this,t.playerOn=null,this.field.playerPos=this.target,this.xPos=this.onItem.x*this.field.xSize,this.yPos=this.onItem.y*this.field.ySize}},t.prototype.drawPlayer=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.alive?this.animate(this.currentDirection,this.cycleLoopPlayer[this.currentLoopIndex],this.xPos,this.yPos):(this.loosingSequence<0?(this.onItem.playerOn=null,this.field.updateGameInfos()):(this.context.fillStyle="red",this.context.fillRect(this.xPos-10,this.yPos-10,20,20)),--this.loosingSequence)},t.prototype.animate=function(t,i,e,s){if(this.running){this.frameCount<=4?this.frameCount%1==0&&(this.currentLoopIndex++,this.currentLoopIndex>=this.cycleLoopPlayer.length&&(this.currentLoopIndex=0)):this.frameCount=0,++this.frameCount,this.context.drawImage(x,t*this.spriteWidth,i*this.spriteHeight,this.spriteWidth,this.spriteHeight,e,s,this.field.xSize,this.field.ySize)}else this.context.drawImage(x,t*this.spriteWidth,0*this.spriteHeight,this.spriteWidth,this.spriteHeight,e,s,this.field.xSize,this.field.ySize)},t}()),m=function(){function t(t,i,e){this.counter=1,this.north=!0,this.south=!0,this.west=!0,this.east=!0,this.explosionRad=e,this.field=i,this.startPosX=t.x,this.startPosY=t.y}return t.prototype.checkBounds=function(t){return t>=0&&t<this.field.items.length},t.prototype.performFire=function(t){this.field.items[t]instanceof l&&this.field.items[t].setOnFire()},t.prototype.update=function(){if(this.counter<this.explosionRad){var t=8*(this.startPosY-this.counter)+this.startPosX,i=8*(this.startPosY+this.counter)+this.startPosX,e=8*this.startPosY+(this.startPosX-this.counter),s=8*this.startPosY+(this.startPosX+this.counter);this.south&&this.checkBounds(i)&&(this.performFire(i),this.field.items[i]instanceof a&&(this.south=!1)),this.north&&this.checkBounds(t)&&(this.performFire(t),this.field.items[t]instanceof a&&(this.north=!1)),this.west&&this.checkBounds(e)&&(this.performFire(e),this.field.items[e]instanceof a&&(this.west=!1)),this.east&&this.checkBounds(s)&&(this.performFire(s),this.field.items[s]instanceof a&&(this.east=!1)),++this.counter}},t}();!function(t){t[t.HALLWAY=0]="HALLWAY",t[t.WALL=1]="WALL",t[t.HOLE=2]="HOLE",t[t.BRICK=3]="BRICK",t[t.USABLEITEM=4]="USABLEITEM"}(d||(d={}));var A=function(){function t(){this.explosions=[],this.playerPos={player0:null,player1:null,player2:null,player3:null},this.field=[{y:0,x:0,state:d.WALL},{y:0,x:1,state:d.WALL},{y:0,x:2,state:d.WALL},{y:0,x:3,state:d.WALL},{y:0,x:4,state:d.WALL},{y:0,x:5,state:d.WALL},{y:0,x:6,state:d.WALL},{y:0,x:7,state:d.WALL},{y:1,x:0,state:d.WALL},{y:1,x:1,state:d.BRICK},{y:1,x:2,state:d.HALLWAY},{y:1,x:3,state:d.HALLWAY},{y:1,x:4,state:d.WALL},{y:1,x:5,state:d.HALLWAY},{y:1,x:6,state:d.HALLWAY},{y:1,x:7,state:d.WALL},{y:2,x:0,state:d.WALL},{y:2,x:1,state:d.WALL},{y:2,x:2,state:d.WALL},{y:2,x:3,state:d.HALLWAY},{y:2,x:4,state:d.WALL},{y:2,x:5,state:d.HALLWAY},{y:2,x:6,state:d.WALL},{y:2,x:7,state:d.WALL},{y:3,x:0,state:d.WALL},{y:3,x:1,state:d.HALLWAY},{y:3,x:2,state:d.HALLWAY},{y:3,x:3,state:d.HALLWAY},{y:3,x:4,state:d.WALL},{y:3,x:5,state:d.HALLWAY},{y:3,x:6,state:d.HALLWAY},{y:3,x:7,state:d.WALL},{y:4,x:0,state:d.WALL},{y:4,x:1,state:d.WALL},{y:4,x:2,state:d.WALL},{y:4,x:3,state:d.HALLWAY},{y:4,x:4,state:d.WALL},{y:4,x:5,state:d.HALLWAY},{y:4,x:6,state:d.WALL},{y:4,x:7,state:d.WALL},{y:5,x:0,state:d.WALL},{y:5,x:1,state:d.HALLWAY},{y:5,x:2,state:d.HALLWAY},{y:5,x:3,state:d.HALLWAY},{y:5,x:4,state:d.USABLEITEM},{y:5,x:5,state:d.HALLWAY},{y:5,x:6,state:d.HALLWAY},{y:5,x:7,state:d.WALL},{y:6,x:0,state:d.WALL},{y:6,x:1,state:d.HALLWAY},{y:6,x:2,state:d.WALL},{y:6,x:3,state:d.HALLWAY},{y:6,x:4,state:d.WALL},{y:6,x:5,state:d.HALLWAY},{y:6,x:6,state:d.HOLE},{y:6,x:7,state:d.WALL},{y:7,x:0,state:d.WALL},{y:7,x:1,state:d.WALL},{y:7,x:2,state:d.WALL},{y:7,x:3,state:d.WALL},{y:7,x:4,state:d.WALL},{y:7,x:5,state:d.WALL},{y:7,x:6,state:d.WALL},{y:7,x:7,state:d.WALL}],this.player=[new L(this.context)];var t=document.getElementById("background");this.context=t.getContext("2d"),this.width=8,this.height=8,this.xSize=(t.width-300)/this.width,this.ySize=t.height/this.height,this.fieldSize=this.field.length,this.items=new Array;for(var i=0;i<this.fieldSize;i++)switch(this.field[i].state){case d.HALLWAY:this.items.push(new l(this.context,this.field[i].x,this.field[i].y,this.xSize,this.ySize)),e=this.items[i];break;case d.HOLE:this.items.push(new c(this.context,this.field[i].x,this.field[i].y,this.xSize,this.ySize));break;case d.WALL:this.items.push(new a(this.context,this.field[i].x,this.field[i].y,this.xSize,this.ySize));break;case d.BRICK:var e;(e=new l(this.context,this.field[i].x,this.field[i].y,this.xSize,this.ySize)).brickOnItem=new y(this.context,this.field[i].x,this.field[i].y,this.xSize,this.ySize,e),this.items.push(e)}for(var s=0,n=this.player;s<n.length;s++){n[s].initField(this,e)}this.playerPos.player0=8*e.y+e.x}return t.prototype.update=function(){for(var t=0;t<this.items.length;t++)if(this.items[t]instanceof l){var i=this.items[t];null!==i.bombOnItem&&i.bombOnItem.explode&&this.explosions.push(new m(i,this,3))}for(var e=0,s=this.explosions;e<s.length;e++){s[e].update()}for(var n=0,h=this.items;n<h.length;n++){h[n].update()}for(var o=0,r=this.player;o<r.length;o++){r[o].renderPlayer()}},t.prototype.drawGame=function(){for(var t=0,i=this.items;t<i.length;t++){i[t].draw()}for(var e=0,s=this.player;e<s.length;e++){s[e].drawPlayer()}},t.prototype.updateGameInfos=function(){this.context.clearRect(480,0,300,480),this.context.fillStyle="yellow",this.context.fillRect(480,0,300,480),this.context.fillStyle="blue",this.context.font="30px Arial",this.context.fillText("Player: TESTNAME",500,50),this.context.font="10px Arial",this.context.fillText("Punkte: 0",520,75),this.player[0].alive||(this.context.fillStyle="red",this.context.fillRect(600,60,100,20),this.context.fillStyle="yellow",this.context.font="10px Arial",this.context.fillText("You loooose xD",600,75)),null!=this.player[0].inventory&&this.player[0].inventory.draw()},t.prototype.returnPlayer=function(){return this.player},t}();new(function(){function t(){this.field=new A,this.player=this.field.returnPlayer(),this.field.updateGameInfos(),this.startAnimating(200)}return t.prototype.startAnimating=function(t){this.frameTime=1e3/60,this.then=window.performance.now(),this.animate(this.then)},t.prototype.animate=function(t){window.requestAnimationFrame(this.animate.bind(this));var i=t;i-this.then>this.frameTime&&(this.then=i,this.field.update(),this.field.drawGame(),this.field.updateGameInfos())},t}())}]);